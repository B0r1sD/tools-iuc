<tool id="fastk_histex" name="FastK Histex" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="23.2" license="MIT">
    <description>Reads and displays a kmer histogram produced by FastK</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <command detect_errors="exit_code"><![CDATA[
        ln -s '$input_hist' input.hist &&
        Histex input.hist
        #if str($range_count).strip():
            -h$range_count
        #end if
        $select_output_format > output.hist
    ]]></command>
    <inputs>      
        <param name="input_hist" type="data" format="fastk_hist" label="Input .hist file" help="Input a .hist file obtained from FASTK"/>
        <param name="range_count" type="text" label="Output histogram of counts in range given" optional="true" help="Requires two numbers seperated by ':' For Eg.1:5"/>
        <param name="select_output_format" label="Select the output format for Histogram" type="select">
            <option value="-k">Output histogram of k-mer instance counts vs. unique k-mers (-k) </option>
            <option value="-A">Output in simple tab-delimited ASCII format (-A) </option>
            <option value="-G">Output an ASCII format histogram especially for GeneScope.FK (-G)</option>   
        </param>
    </inputs>
    <outputs>
        <data name="histex_out" format="txt" from_work_dir="output.hist" label="${tool.name} on ${on_string}: FastK Histogram"/>
    </outputs>
    <tests>
        <test expect_num_outputs="1">
            <param name="input_hist" value="test01.hist"/>
            <param name="select_output_format" value="-k"/>
            <output name="histex_out" ftype="txt">
                <assert_contents>
                    <has_n_lines n="13"/>
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="1">
            <param name="input_hist" value="test01.hist"/>
            <param name="range_count" value="1:5"/>
            <param name="select_output_format" value="-k"/>
            <output name="histex_out" ftype="txt">
                <assert_contents>
                    <has_n_lines n="11"/>
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="1">
            <param name="input_hist" value="test01.hist"/>
            <param name="select_output_format" value="-G"/>
            <output name="histex_out" ftype="txt">
                <assert_contents>
                    <has_n_lines n="7"/>
                    <has_n_columns n="2"/>
                </assert_contents>
            </output>
        </test>
    </tests>
    <help><![CDATA[
        **FastK Histex**

        Histex is a tool part of FASTK suite which performs reading and displaying a kmer histogram produced by FastK. Histex requires the .hist file generated by the FASTK tool to view the histogram of kâ€‘mer counts.
    
    ]]></help>
    <expand macro="citations"/>
</tool>