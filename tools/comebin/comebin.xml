<tool id="comebin" name="COMEBin" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="@PROFILE@">
    <description>PLACEHOLDER!!!!!!!!!!!!!!!!!!!</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirement"/>
    <command detect_errors="exit_code">
        <![CDATA[

            mkdir outputs bam_files &&

            ln -s '$assembly_file' 'assembly_file.fasta' &&

            #for $i, $file in enumerate('$ba,_files'):
                ln -s '$file' './bam_files/${i}.bam' &&

            run_comebin.sh
            -a 'assembly_file.fasta'
            -o 'outputs'
            -p 'bam_files'
            -t \${GALAXY_SLOTS:-5}
            -l ${loss}
            -e ${emb_comebin}
            -c ${emb_cov}
            -b {batch}
        
        ]]>
    </command> 
    <inputs>
        <param name="assembly_file" type="data" format="fasta" label="Input assembly file"/>
        <param name="bam_files" type="data" format="bam" multiple="true" label="Input bam file(s)"/>
        <param name="learning" type="integer" default_value="6" label="Views for contrastive multiple-view learning"/>
        <param name="loss" type="float" default_value="0.15" label="Temperature in loss function"/>
        <param name="emb_comebin" type="integer" default_value="2048" label="Embedding size for COMEBin network"/>
        <param name="emb_cov" type="integer" default_value="2048" label="Embedding size for coverage network"/>
        <param name="batch" type="integer" default_value="1024" label="Batch size"/>
    </inputs>
    <outputs>
        <collection name="bins" type="list" label="${tool.name}: BINS">
            <discover_datasets pattern="__name__" directory="outputs/comebin_res/comebin_res_bins/"/>
        </collection>
    </outputs>
    <tests>

    </tests>
    <help>

    </help>
    <expand macro="citations"/>
</tool>